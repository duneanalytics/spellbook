version: 2

sources:
  - name: tokens_bitcoin
    database: tokens_bitcoin
    schema: tokens_bitcoin
    tables:
      - name: balances_daily_agg_base
        description: "Token balances daily base for Bitcoin"
        columns:
          - name: day
          - name: block_number
          - name: block_time
          - name: address
          - name: token_address
          - name: token_standard
          - name: token_id
          - name: balance_raw
          - name: unique_key

models:
  - name: tokens_bitcoin_balances_daily_agg_base
    meta:
      blockchain: bitcoin
      sector: tokens
      contributors: abnerhenriq
    config:
      tags: ['tokens','balances', 'bitcoin']
    description: "Token balances daily base for Bitcoin"
    columns:
      - name: day
      - name: block_number
      - name: block_time
      - name: address
      - name: token_address
      - name: token_standard
      - name: token_id
      - name: balance_raw
      - name: unique_key

  - name: balances_bitcoin_satoshi_day
    meta:
      blockchain: bitcoin
      sector: tokens
      contributors: abnerhenriq
    config:
      tags: ['tokens','balances', 'bitcoin']
    description: "Daily Bitcoin balances in satoshi"
    columns:
      - name: blockchain
      - name: day
      - name: wallet_address
      - name: amount_raw
      - name: amount
      - name: price_btc
      - name: profit
      - name: amount_usd
      - name: total_asset
      - name: updated_at

  - name: balances_bitcoin_satoshi_latest_day
    meta:
      blockchain: bitcoin
      sector: balances
      project: satoshi
      contributors: gandalf
    config:
      tags: ['latest', 'balances', 'bitcoin', 'satoshi', 'day', 'gandalf']
    description: "Latest token balances of Satoshi Bitcoin per wallet"
    columns:
      - name: blockchain
        description: "Chain name"
      - name: day
        description: "UTC event block time truncated to the day mark"
      - name: wallet_address
        description: "Wallet address of sender or receiver. If amount is negative, wallet address is the sender's."
      - name: amount_raw
        description: "The number of Satoshis in the wallet"
      - name: amount
        description: "The number of Bitcoins in the wallet"
      - name: price_btc
        description: "Price of btc at day"
      - name: profit
        description: "Profit by USD of the wallet"
      - name: amount_usd
        description: "USD balance of the wallet"
      - name: total_asset
        description: "Total asset by USD of the wallet"
      - name: updated_at
        description: "When the balances were last updated"

  - name: tokens_bitcoin_net_transfers_daily
    meta:
      blockchain: bitcoin
      sector: tokens
      contributors: krishhh
    config:
      tags: ['tokens', 'net_transfers', 'daily']
    description: "Total transfer amount per day"
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - blockchain
            - block_date
    columns:
      - name: blockchain
        description: "The blockchain network"
      - name: block_date
        description: "The date of the block"
      - name: net_transfer_amount_usd
        description: "The total net transfer amount for the day"

  - name: tokens_bitcoin_net_transfers_daily_asset
    meta:
      blockchain: bitcoin
      sector: tokens
      contributors: [0xRob, krishhh]
    config:
      tags: ['tokens', 'net_transfers']
    description: "Total transfer amount per day per asset"
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - blockchain
            - block_date
            - contract_address
    columns:
      - name: blockchain
        description: "The blockchain network"
      - name: block_date
        description: "The date of the block"
      - name: contract_address
        description: "The contract address of the asset"
      - name: symbol
      - name: net_transfer_amount_usd
        description: "The total net transfer amount for the day and asset"

  - name: transfers_bitcoin_satoshi
    meta:
      blockchain: bitcoin
      sector: transfers
      project: satoshi
      contributors: longnhbkhn
    config:
      tags: ["transfers", "bitcoin", "satoshi"]
    description: "Transfer satoshi in Bitcoin"
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - type
            - tx_id
            - index
            - wallet_address
    columns:
      - name: type
      - name: tx_id
      - name: index
      - name: blockchain
        description: "Chain name"
      - name: wallet_address
        description: "Wallet address of sender or receiver"
      - name: block_time
        description: "The block time"
      - name: block_date
        description: "The block date"
      - name: block_height
        description: "The block number"
      - name: amount_raw
        description: "The number of Satoshis in the wallet"
      - name: amount_transfer_usd
        description: "Amount of the transfer by usd"

  - name: transfers_bitcoin_satoshi_agg_day
    meta:
      blockchain: bitcoin
      sector: transfers
      project: satoshi
      contributors: longnhbkhn
    description: "Transfer satoshi aggregate in Bitcoin by day"
    config:
      tags: ['transfers', 'bitcoin', 'satoshi', 'agg_day', 'longnhbkhn']
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - day
            - wallet_address
    columns:
      - name: blockchain
        description: "Chain name"
      - name: day
        description: "UTC event block time truncated to the day mark"
      - name: wallet_address
        description: "Wallet address of sender or receiver"
      - name: amount_raw
        description: "The number of Satoshis in the wallet"
      - name: amount_transfer_usd
        description: "Amount of the transfer by usd"

  - name: transfers_bitcoin_satoshi_rolling_day
    meta:
      blockchain: bitcoin
      sector: transfers
      project: satoshi
      contributors: longnhbkhn
    description: "Number satoshi was hold by wallet"
    config:
      tags: ['transfers', 'bitcoin', 'satoshi', 'rolling_day', 'longnhbkhn']
    columns:
      - name: blockchain
        description: "Chain name"
      - name: day
        description: "UTC event block time truncated to the day mark"
      - name: wallet_address
        description: "Wallet address of sender or receiver"
      - name: amount_raw
        description: "The number of Satoshis in the wallet"
      - name: amount_transfer_usd
        description: "Amount of the transfer by usd"
      - name: last_updated
        description: "UTC timestamp when table was last updated"
      - name: recency_index
        description: "Index of most recent balance ascending. recency_index=1 is the wallet/contract pair's most recent balance"

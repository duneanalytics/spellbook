version: 2

models:

  - name: tokens_solana_fees_history
    meta:
      blockchain: solana
      sector: tokens
      project: fees
      contributors: ilemi
    config:
      tags: ['table', 'metadata', 'fess', 'solana']
    description: "fee updates on token2022 tokens"
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - account_mint
            - fee_time
    columns:
      - name: account_mint
        description: "fungible token mint address on Solana"
      - name: fee_basis
        description: basis points fee on transfers
      - name: fee_maximum
        description: maximum fee amount on a given transfer
      - name: fee_time
        description: fee update time

  - name: tokens_solana_nft
    meta:
      blockchain: solana
      sector: tokens
      project: fungible
      contributors: ilemi
    config:
      tags: ['table', 'metadata', 'fungible', 'solana']
    description: "NFTs minted using the Metaplex standard, with a master edition or cNFT tree"
    columns:
      - name: account_mint_authority
        description: "mint authority for the account. this is set so that the account cannot mint more tokens"
      - name: account_merkle_tree
        description: only applies to cNFTs, this is the tree the NFT is appended to
      - name: leaf_id
        description: only applies to cNFTs, this is the leaf ID of the NFT (order of append)
      - name: account_master_edition
        description: "master edition for the account. all NFTs have a master edition"
      - name: account_metadata
        description: "metadata for the account. contains stuff like the name, symbol, and uri, etc"
      - name: account_mint
        description: "mint for the account. this is the token mint address from spl_token"
      - name: minter
        description: "the account_payer or account_leafOwner that minted the NFT"
      - name: version
        description: "version of the NFT - Token Metdata, cNFT, etc"
      - name: token_standard
      - name: token_name
      - name: token_symbol
      - name: token_uri
      - name: seller_fee_basis_points
      - name: collection_mint
        description: "this is the token mint address of the collection. this is the same for all NFTs in the collection"
      - name: verified_creator
        description: "this is the first creator in the creator_struct for the NFT. the first creator was originally used as the collection mint reference"
      - name: creator_struct
        description: "all creators and their royalty splits"
      - name: call_tx_id
      - name: call_block_time
      - name: call_block_slot
      - name: call_tx_signer

  - name: tokens_solana_stablecoins
    meta:
      blockchain: solana
      sector: tokens
      project: stablecoins
      contributors: synthquest
    config:
      tags: ['table', 'metadata', 'stablecoins', 'solana']
    description: "Stablecoins on Solana blockchain with their details"
    columns:
      - name: blockchain
        description: "The blockchain on which the stablecoin is issued"
      - name: symbol
        description: "The symbol of the stablecoin"
      - name: address
        description: "The address of the stablecoin on the Solana blockchain"
        data_tests:
          - unique
      - name: decimals
        description: "The number of decimal places the stablecoin can be divided into"
      - name: backing
        description: "The type of backing for the stablecoin (e.g., Fiat Stablecoin, Dollar-Pegged)"
      - name: name
        description: "The name of the issuer or protocol of the stablecoin"

  - name: tokens_solana_rwa_transfers
    meta:
      blockchain: solana
      sector: tokens
      project: rwa
      contributors: ilemi
    config:
      tags: ['solana', 'tokens', 'rwa', 'transfers']
    description: "Real World Asset (RWA) token transfers on Solana, filtered from tokens_solana.transfers with optimized date-based filtering using token creation dates from tokens_solana.fungible"
    columns:
      - name: block_time
        description: "Timestamp of the block containing this transfer"
      - name: block_date
        description: "Date of the block containing this transfer (partition key)"
      - name: block_slot
        description: "Slot number of the block"
      - name: action
        description: "Type of action (transfer, mint, burn, etc.)"
      - name: token_mint_address
        description: "The mint address of the RWA token"
      - name: amount
        description: "Raw amount transferred (before decimal adjustment)"
      - name: fee
        description: "Fee charged for the transfer"
      - name: token_version
        description: "Version of the token program (spl_token or token2022)"
      - name: from_owner
        description: "Owner address of the source token account"
      - name: to_owner
        description: "Owner address of the destination token account"
      - name: from_token_account
        description: "Source token account address"
      - name: to_token_account
        description: "Destination token account address"
      - name: tx_signer
        description: "Transaction signer address"
      - name: tx_id
        description: "Transaction ID"
      - name: tx_index
        description: "Index of the transaction in the block"
      - name: outer_instruction_index
        description: "Index of the outer instruction"
      - name: inner_instruction_index
        description: "Index of the inner instruction"
      - name: outer_executing_account
        description: "Account executing the outer instruction"
      - name: symbol
        description: "Token symbol from fungible dataset"
      - name: decimals
        description: "Number of decimals for the token"
      - name: amount_decimal
        description: "Amount adjusted for token decimals (human-readable)"
version: 2

sources:
  - name: erc4337_zora
    tables:
      - name: EntryPoint_evt_AccountDeployed
        description: "Events for account deployments on Zora network"
      - name: EntryPoint_evt_UserOperationEvent
        description: "Events for user operations on Zora network"
      - name: EntryPoint_call_handleOps
        description: "Calls to handle operations on Zora network"
      - name: EntryPoint_v0_6_evt_AccountDeployed
        description: "Events for account deployments on Zora network v0.6"
      - name: EntryPoint_v0_6_evt_UserOperationEvent
        description: "Events for user operations on Zora network v0.6"
      - name: EntryPoint_v0_6_call_handleOps
        description: "Calls to handle operations on Zora network v0.6"

models:
  - name: account_abstraction_erc4337_zora_v0_5_userops_basics
    meta:
      blockchain: zora
      sector: erc4337
      project: erc4337
      contributors: thegr8liberator
    config:
      tags: ["zora", "erc4337", "account", "abstraction", "entrypoint"]
    description: "erc4337 v0.5 user operations on Zora network"
    columns:
      - name: blockchain
        description: "blockchain which EntryPoint was deployed"
      - name: version
        description: "version of the EntryPoint contract"
      - name: block_month
        description: "UTC event block date of each User Operation"
      - name: block_time
        description: "UTC event block time of each User Operation"
      - name: entrypoint_contract
        description: "the contract address of the EntryPoint"
      - name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the User Operation"
      - name: sender
        description: "the sender(AA wallet address) that submitted the user operation"
      - name: userop_hash
        description: "Unique user operation hash"
      - name: success
        description: "whether the user operation is successfully executed"
      - name: paymaster
        description: "the address that pays for the user operation gas fees on behalf of the user"
      - name: op_fee
        description: "The gas paid by sender or paymaster, depending on the chain gas setting"
      - name: beneficiary
        description: "the address where the bundler setting for the user operation pays for their gas fee"

  - name: account_abstraction_erc4337_zora_v0_6_userops_basics
    meta:
      blockchain: zora
      sector: erc4337
      project: erc4337
      contributors: thegr8liberator
    config:
      tags: ["zora", "erc4337", "account", "abstraction", "entrypoint"]
    description: "erc4337 v0.6 user operations on Zora network"
    columns:
      - name: blockchain
        description: "blockchain which EntryPoint was deployed"
      - name: version
        description: "version of the EntryPoint contract"
      - name: block_month
        description: "UTC event block date of each User Operation"
      - name: block_time
        description: "UTC event block time of each User Operation"
      - name: entrypoint_contract
        description: "the contract address of the EntryPoint"
      - name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the User Operation"
      - name: sender
        description: "the sender(AA wallet address) that submitted the user operation"
      - name: userop_hash
        description: "Unique user operation hash"
      - name: success
        description: "whether the user operation is successfully executed"
      - name: paymaster
        description: "the address that pays for the user operation gas fees on behalf of the user"
      - name: op_fee
        description: "The gas paid by sender or paymaster, depending on the chain gas setting"
      - name: beneficiary
        description: "the address where the bundler setting for the user operation pays for their gas fee"

  - name: account_abstraction_erc4337_zora_userops
    meta:
      blockchain: zora
      sector: erc4337
      project: erc4337
      contributors: thegr8liberator
    config:
      tags: ["zora", "erc4337", "account", "abstraction", "entrypoint"]
    description: "erc4337 user operation on Zora network"
    tests:
      - check_seed:
          seed_file: ref('account_abstraction_erc4337_userops_seed')
          filter:
            blockchain: zora
            version: v0.5
          match_columns:
            - userop_hash
            - tx_hash
          check_columns:
            - paymaster
            - bundler
      - check_seed:
          seed_file: ref('account_abstraction_erc4337_userops_seed')
          filter:
            blockchain: zora
            version: v0.6
          match_columns:
            - userop_hash
            - tx_hash
          check_columns:
            - paymaster
            - bundler
    columns:
      - name: blockchain
        description: "blockchain which EntryPoint was deployed"
      - name: version
        description: "version of the EntryPoint contract"
      - name: block_month
        description: "UTC event block date of each User Operation"
      - name: block_time
        description: "UTC event block time of each User Operation"
      - name: entrypoint_contract
        description: "the contract address of the EntryPoint"
      - name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the User Operation"
      - name: sender
        description: "the sender(AA wallet address) that submitted the user operation"
      - name: userop_hash
        description: "Unique user operation hash"
      - name: success
        description: "whether the user operation is successfully executed"
      - name: paymaster
        description: "the address that pays for the user operation gas fees on behalf of the user"
      - name: op_fee
        description: "The gas paid by sender or paymaster, depending on the chain gas setting"
      - name: op_fee_usd
        description: "The user operation gas (in usd) paid by sender or paymaster."
      - name: bundler
        description: "address that bundles UserOps and submits those UserOps to the final on-chain by sending an EOA transaction. It is the transaction from address"
      - name: tx_to
        description: "address where the bundler sends the transaction"
      - name: gas_symbol
        description: "the gas symbol paid for the transaction"
      - name: tx_fee
        description: "the bundler paid gas value for the transaction"
      - name: tx_fee_usd
        description: "the bundler paid gas (in usd) value for the transaction"
      - name: beneficiary
        description: "the address where the bundler setting for the user operation pays for their gas fee"

  - name: account_abstraction_erc4337_zora_v0_5_account_deployed
    meta:
      blockchain: zora
      sector: erc4337
      project: erc4337
      contributors: thegr8liberator
    config:
      tags: ["zora", "erc4337", "account", "abstraction", "entrypoint"]
    description: "erc4337 v0.5 account deployed on Zora network"
    columns:
      - name: blockchain
        description: "blockchain which EntryPoint was deployed"
      - name: version
        description: "version of the EntryPoint contract"
      - name: block_time
        description: "UTC event block time of each User Operation"
      - name: block_month
        description: "UTC event block date of each User Operation"
      - name: userop_hash
        description: "Unique user operation hash"
      - name: entrypoint_contract
        description: "the contract address of the EntryPoint"
      - name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the User Operation"
      - name: sender
        description: "the sender(AA wallet address) that submitted the user operation"
      - name: paymaster
        description: "the address that pays for the user operation gas fees on behalf of the user"
      - name: factory
        description: "who can create a new AA Wallet. It's a smart contract address"

  - name: account_abstraction_erc4337_zora_v0_6_account_deployed
    meta:
      blockchain: zora
      sector: erc4337
      project: erc4337
      contributors: thegr8liberator
    config:
      tags: ["zora", "erc4337", "account", "abstraction", "entrypoint"]
    description: "erc4337 v0.6 account deployed on Zora network"
    columns:
      - name: blockchain
        description: "blockchain which EntryPoint was deployed"
      - name: version
        description: "version of the EntryPoint contract"
      - name: block_time
        description

version: 2

models:
  - name: addresses_events_arbitrum_first_funded_by
    meta:
      blockchain: arbitrum
      sector: addresses_events
      project: addresses
      contributors: hildobby
    config:
      tags: ['table', 'funded', 'addresses_events', 'arbitrum']
    description: "Table showing who first funded each Arbitrum address in ETH"
    tests:
      - check_seed:
          seed_file: ref('first_funded_by_seed')
          filter:
            blockchain: arbitrum
          match_columns:
            - blockchain
            - address
          check_columns:
            - first_funded_by
            - block_number
            - tx_hash
    columns:
      - name: blockchain
        description: "Blockchain"
      - name: address
        description: "Concerned Arbitrum address"
        tests:
          - unique
      - name: first_funded_by
        description: "Which Arbitrum address first funded the address with ETH"
      - name: block_time
        description: "The block time on which the address was first funded with ETH"
      - name: block_number
        description: "The block number on which the address was first funded with ETH"
      - name: tx_hash
        description: "The transaction hash on which the address was first funded with ETH"

  - name: addresses_events_arbitrum_first_activity
    meta:
      blockchain: arbitrum
      sector: addresses_events
      project: addresses
      contributors: Henrystats
    config:
      tags: ['table', 'activity', 'addresses_events', 'arbitrum']
    description: "Table showing first activity of each Arbitrum Mainnet address"
    tests:
      - check_seed:
          seed_file: ref('first_activity_seed')
          filter:
            blockchain: arbitrum
          match_columns:
            - address
          check_columns:
            - first_activity_to
            - first_block_number
            - first_tx_hash
    columns:
      - name: blockchain
        description: "Blockchain"
      - name: address
        description: "Concerned Arbitrum Mainnet address"
        tests:
          - unique
      - name: first_activity_to
        description: "First transaction activity to address"
      - name: first_block_time
        description: "The block time on which the address made it's first activity"
      - name: first_block_number
        description: "The block number on which the address made it's first activity"
      - name: first_tx_hash
        description: "The transaction hash on which the address made it's first activity"
      - name: first_function
        description: "first function called by address"
      - name: first_eth_transferred
        description: "ETH transferred in transaction"

  - name: addresses_events_arbitrum_first_received
    meta:
      blockchain: arbitrum
      sector: tokens
      contributors: hildobby
    config:
      tags: ['tokens','transfers', 'first', 'received', 'arbitrum']
    description: >
      First token received by every address on arbitrum
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - address
    columns:
      - name: unique_key
        description: "Surrogate key to identify unique row"
      - name: blockchain
        description: "The blockchain of the transfers"
      - name: block_date
        description: "The date of the block"
      - name: block_time
        description: "The time of the block"
      - name: block_number
        description: "The block number"
      - name: tx_hash
        description: "The transaction hash"
      - name: evt_index
        description: "The log event index of the transfer if any"
      - name: trace_address
        description: "The trace address of the transfer if any"
      - name: token_standard
        description: "The token standard of the transfer"
      - name: tx_from
        description: "The transaction sender"
      - name: tx_to
        description: "The transaction receiver"
      - name: tx_index
        description: "The transaction index"
      - name: from
        description: "The sender of the transfer"
      - name: address
        description: "The receiver of the transfer"
      - name: contract_address
        description: "The contract address of the transfer"
      - name: symbol
        description: "The token symbol transferred"
      - name: amount_raw
        description: "The raw amount of the transfer"
      - name: amount
        description: "The formatted amount of the transfer"
      - name: price_usd
        description: "The USD price used to calculate the amount_usd"
      - name: amount_usd
        description: "The USD amount of the transfer"
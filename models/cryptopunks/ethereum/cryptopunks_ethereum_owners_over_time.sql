{{ config(
        alias ='owners_over_time',
        unique_key='punk_id',
        post_hook='{{ expose_spells(\'["ethereum"]\',
                                    "project",
                                    "cryptopunks",
                                    \'["cat"]\') }}'
        )
}}

with original_holders as (
    select address, original_count
    from (VALUES
        ('0xc352b534e8b987e036a93539fd6897f53488e56a', 1020)
        , ('0x00d7c902fbbcd3c9db2da80a439c94486c50eb81', 1005)
        , ('0x53ede7cae3eb6a7d11429fe589c0278c9acbe21a', 919)
        , ('0xcbd482af76059e2a5e4a825c4cd5ced9f2dfe286', 731)
        , ('0x00bd9fd57c423a1b1c969823d409156d90974d77', 504)
        , ('0x6f4a2d3a4f47f9c647d86c929755593911ee91ec', 319)
        , ('0x6611fe71c233e4e7510b2795c242c9a57790b376', 289)
        , ('0xcc7c335f3365ae3f7e4e8c9535dc92780a4add9d', 200)
        , ('0xe45df57df7980d8219a5ea811aff949907d0a355', 195)
        , ('0x48db199821bbd5be47c29bb242e3cdf1ef099d7e', 192)
        , ('0xc24f574d6853f6f6a31c19d468a8c1b3f31c0e54', 180)
        , ('0x26f744711ee9e5079cbeaf318ba8a8e938844de6', 141)
        , ('0x8234be55f64ea91960b78357906cf5bebce81f3d', 140)
        , ('0x58164b2d74c45f06cde451fc307092d55ebe5730', 137)
        , ('0xba7ccc2f5e04425617589665e27fdd41e6557dfc', 129)
        , ('0xe4d36bb198a38fc1d5aee62164831e86dfcdac88', 121)
        , ('0x5b098b00621eda6a96b7a476220661ad265f083f', 119)
        , ('0xb6be4de7f37bae20085d830a28982be8ad19052b', 113)
        , ('0x8b27de7f6a7542ee70e2420e1bc67fc479d01984', 112)
        , ('0x5f7190b7943858b7bdd24f069241612091c6a986', 109)
        , ('0x1335242f595f7da21ba9dd5cf2bd75d143be6a30', 105)
        , ('0x94de7e2c73529ebf3206aa3459e699fbcdfcd49b', 104)
        , ('0x6301add4fb128de9778b8651a2a9278b86761423', 103)
        , ('0x682c303ce4c38c275cf23b38656340d6ba322832', 100)
        , ('0x207355e167cb42cd93dd38a784016b2d2e93c840', 98)
        , ('0xc480fb0ebea2591470f571436926785be5ebcd22', 91)
        , ('0xc272ed09c636edb6e858fa8702c182406185f1af', 86)
        , ('0xf1ad946ae30a285d96ea396acd3fd22c5aa75ef8', 84)
        , ('0x0f4023208058ecffcb22a7409df11f6d6013fe8a', 83)
        , ('0xc2f87f88df0f2c602a9a7dc2e89cecdb9790d972', 78)
        , ('0x38740516f691a66b4c1cd9156e9434c7915e73b3', 72)
        , ('0xff84140cedeee480b804d211b48a2a6d68ba5941', 65)
        , ('0x19f23312627e560ea0199345782528686f1f3968', 63)
        , ('0xbc081c23b3b8c6cf1464e98eb108c13c6f8cba1c', 60)
        , ('0x23170777466de6046ff42bd5abcf525077e3ce27', 59)
        , ('0x8321795bdace7428d4fadfa30c2ee8e727e491e5', 55)
        , ('0x470e9bd486ebf96ddf6b38de58f21b0872f85776', 51)
        , ('0x22160e8a944e4f4f8aced15f54b265bfd12854e2', 48)
        , ('0x3ef5f421e155ed29e6fa815fd875bfcd5f22ecd1', 46)
        , ('0x005734d7d408bccf41cff34b46244551d01f0a6b', 43)
        , ('0xa6e2e910515e6cf485462eeb6e454df33c60cb0e', 43)
        , ('0x515a82d6bed3fd76ca65ba505482545bf1dfcca1', 41)
        , ('0x36a5bc205df1ed65c86301022cfc343a6ce546ff', 38)
        , ('0x5462dee16b3f4d240ebbe52c9c4214c912ccdda4', 37)
        , ('0xe03559ea7be32a6b7152ba745fadb7e07a772bff', 37)
        , ('0x0b30fd3a500608413837bb025c2018933130f9db', 36)
        , ('0x47d4f20ae83bcd350105f199f900e6e6104dab6a', 36)
        , ('0x0da0df4be467140e74c76257d002f52e954be4d3', 34)
        , ('0xfb077c541507ed890abb7e670180b97ccbac0e9c', 33)
        , ('0xef768ef781637a7995a2b57ff77825e8abcf682d', 32)
        , ('0x4d17cf47aaa1f6fbb39f73b2d310cefb98a6fd0a', 31)
        , ('0xc00c2bcb33f0600ee5466f0f7424ce4a7150e7c8', 31)
        , ('0xbfe1f878e7ca3679ebae3accc45d56cc1aa0583c', 30)
        , ('0x723e66adff8760d522dd500e83ba56a3203aab33', 29)
        , ('0x01ec738293d4fa32d99374a4519b450f4db2ba54', 28)
        , ('0xd8e80673419acfbf15bf8eb0239cda90f232051f', 28)
        , ('0x887caa489a0701856326790f0b5d8a0615678c19', 27)
        , ('0xf138eb67f008da11daba9bcffc7a21f31b8b2b14', 26)
        , ('0x28b564f44a13f3fa5ef9695116822c89c9cb2a5a', 25)
        , ('0x2fdacd67d255e6ee62e6fe3788dc435863b8539c', 25)
        , ('0xa7eba7fda7e463c5509519edf03137c57f3ebe73', 24)
        , ('0x289d953cf25d51abbc825faac3c260c10eda72cf', 23)
        , ('0x00ce50f8333b5176c22ac7948993978b2e011cda', 22)
        , ('0x99b88481d3b439a4ab8ce43c939b394d03d5394c', 21)
        , ('0xc0f5ddace8074496314c219283f56b576c43ca39', 21)
        , ('0x0053f28decb7184d73a0d776aff540ea09ec6a2c', 20)
        , ('0x4bc2cc705bb6aecf9ece4e21d4aa1470bab3d455', 20)
        , ('0x0bf913bedf5c6aca673db3b697a4e543550ceb4d', 19)
        , ('0x44fab57dba0e643018c06d83cc8d658980b7ee08', 19)
        , ('0xd4fa6e82c77716fa1ef7f5defc5fd6eeefbd3bff', 19)
        , ('0x20e386ca32b7f545168402841a7cef228b479658', 18)
        , ('0xde0193fcaf598104bf001133354d9f84c35ddb4b', 18)
        , ('0x1e32a859d69dde58d03820f8f138c99b688d132f', 17)
        , ('0x585f98cf291f081405412edafcf471d19003ca9c', 17)
        , ('0xdd9d84399a8e81602e89f5bfef4c138b7908fc55', 17)
        , ('0xe1cd086fae61364c6d58db6f05e80929426788bd', 17)
        , ('0xb38071b23f0fa92cf9e1bd6feec5a5f9821f3ccc', 16)
        , ('0x0057009257307484a6913157598d1b1d6c23bd3d', 15)
        , ('0x02751f403279370dd20a50effb915802b844dd67', 15)
        , ('0x365e35652879023f12b5cf4c44eb9c1cf2f6f549', 15)
        , ('0x8ac65ff8600810e3470705cacb35a80fa218355a', 15)
        , ('0x98cfea4a7632ef7148b2f6933c5af622d16b956b', 15)
        , ('0xfba169cc807ed66cef816144fcbd2e36b6142422', 15)
        , ('0x0ed6fed4df8480c1d1b3b78537cfb8f9c22a81ef', 14)
        , ('0x7447397496b36962594438e006862c99b21b1689', 14)
        , ('0xded2cb7109ebfe5e6ef409995b0af2211a22a6c9', 14)
        , ('0x4c1147725bac8c98c0ee45ea09d650ae34f5165e', 13)
        , ('0x51ec89f1fcfed8c69a1b0865a7550ece0677cf5f', 13)
        , ('0x8b7a5b22175614ee194e9e02e9fe0a1b5414c75e', 13)
        , ('0xa9bfa94ab1497c08b7c02c9516d4eb1f07c90d40', 13)
        , ('0x06bf2b4da028b66fb08a75dd872acb9a483e5639', 12)
        , ('0x1266190e6e09667f2f08685f262f5561562443f7', 12)
        , ('0x1672dbd790d9fa182dcd12d8521c6e68037ead8e', 12)
        , ('0x2bcbbdc3926b670f46732b9a314230b5ea144568', 12)
        , ('0x45c74aaad6720718159be12e9c7cc7edcaa87125', 12)
        , ('0x71710e1a6b5e5440f2822577698955aff74fd831', 12)
        , ('0xba0c68d6b353c2c36a657289e24ba36fe7172d2f', 12)
        , ('0x22ff031aa03a2f008e6a297cfdb1f66efbae0fff', 11)
        , ('0x28c42de479e57cc0c90b8a3eceb406dc173ad7cc', 11)
        , ('0x94f67de48a70fde96396f767a2ce5719af7f1bdb', 11)
        , ('0x003a9786c858f50fab79cb6bedc364697373bfc6', 10)
        , ('0x00dab6b11fa446adaa0cbd4ccdb1626c47e39ab8', 10)
        , ('0x0544fbed9b72aa036517b21d1db50201a17d09ce', 10)
        , ('0xb0b0b51158ec4d8995c9b83cf59853d9f2611615', 10)
        , ('0xc8e0e13d7074a9a66854374a6ea98491cb739b28', 10)
        , ('0x78f0a6385028eea69a527d8a3c4cd1092651972c', 9)
        , ('0x7a304b7664fe3066ea3cd3fed03f062af78380cf', 9)
        , ('0x800b4dbcef65cb5d1b2f8e33d5d0bbcbffea2a8e', 9)
        , ('0x8851dc136be0cf67802c0b791ec44d1af9a66734', 9)
        , ('0x00e9e6cd89d52d6ec938293803389f4dd03e9431', 8)
        , ('0x067107af3512a78eabb735d8bf011dac2e6e096a', 8)
        , ('0x45055cb39b6e8c1b8e877a2a8179d78a3539e31a', 8)
        , ('0xaebe68c4d463e29ff5e24f393c054b9478f2a12b', 8)
        , ('0xb044aff5d2f044da7d40785d88d2f2cb4ec5f324', 8)
        , ('0x1c38e6b7a886a8d5dde7c12ef896a0352abd5775', 7)
        , ('0x38f18a1d84e720b042900cb99187798acba4b045', 7)
        , ('0x595bd0b6b3d996a67118ad642d0d045bb21d5693', 7)
        , ('0x670d7542947f0dd01342d5b3cdbe2b818f8908ea', 7)
        , ('0x729fcb34c7c84af5fb9a4ad514bae745d30c9aab', 7)
        , ('0x89ba624ca607a13533247bee0a7d4c214a2730d8', 7)
        , ('0xb05b7dd93264f87d9810b3641be8bbfd1bf9a062', 7)
        , ('0xc5d739a29e3f97b59ddb1d8f46aaa2e46496d462', 7)
        , ('0xccc2304cd3c4532e83d6e81f74290fa392f209ea', 7)
        , ('0xd93033ac253ce4320128666d999c392cfc09a523', 7)
        , ('0xdae48d7b5c73a95f74caae08f7f92d3b7927f449', 7)
        , ('0x007508a6c38bcf12a30728c363968dab1be6384a', 6)
        , ('0x6e5b3f763b2dd5582493c7123cfdc323259a7a00', 6)
        , ('0x73e4a2b60cf48e8baf2b777e175a5b1e4d0c2d8f', 6)
        , ('0x8c6d56e641164b9fa951d7fa9a80bc124e6278c9', 6)
        , ('0xbbaf6df069adfcab1a13af21d12064e4f5ea41af', 6)
        , ('0xc182d81b3c3bb743b8660eb41fb36780a910d106', 6)
        , ('0x000001f568875f378bf6d170b790967fe429c81a', 5)
        , ('0x00000217d2795f1da57e392d2a5bc87125baa38d', 5)
        , ('0x0642f69c4c4a12310a081c8267e96523953c688d', 5)
        , ('0x0873fc66dd231a9740f5f64ecb11e5e2a3d4a08e', 5)
        , ('0x2b616914ada8484ab9d70398dbe86b029b1a9a39', 5)
        , ('0x51306877c61df89ad7b165d6206eb636276d1083', 5)
        , ('0x7797cf5b68bb6a62b7d37d628fd72ec216111cb1', 5)
        , ('0xaec98826319ef42aab9530a23306d5a9b113e23d', 5)
        , ('0xc46f437244770dd7a9d82d93cb3e4f5b03ff3b8e', 5)
        , ('0xfaf9f63baf57b19ca4e9490aaab1ede8b66cc2b5', 5)
        , ('0x01486c3891761e93e5107890286abdc1834fc6d7', 4)
        , ('0x2014ae8b1d21f571c194c682c1758f2dd874c138', 4)
        , ('0x3fba2d2da359ab8feae2bc451cc6a442e5d687e2', 4)
        , ('0x54107553606509adf188b012b4c890e10937d309', 4)
        , ('0x60206cfedf6eb2d9c1132390da5c7d99519b6e7f', 4)
        , ('0x606e83ad850a289bb588a908b4ab7782d5e79be2', 4)
        , ('0x60fe3e0e5468a3184109feda6466f42588484fa6', 4)
        , ('0x6c22fa46cb7fabd775bb0c4e13948e75aa458a60', 4)
        , ('0x787b9295bd8631d5749eb3aaab8ffd9f381e3592', 4)
        , ('0x7e2d1cad77532072a33cb6e40c4eecd4d96b6cd0', 4)
        , ('0x7eac94ecd60738ebce2baa48004e31e69481a837', 4)
        , ('0x846d55eba18942d607596fdacf9c32e3fbeb2ce3', 4)
        , ('0x88810436096cbca24b61c76153d19cfedd0da35b', 4)
        , ('0x8bb4f3be31bc5aac56c75a41522b1e0d517aabc0', 4)
        , ('0x99652fe944e5e921be91a66e37bd389dca86676d', 4)
        , ('0x996737253bc72d0196f5d4110d679b0566dc3e84', 4)
        , ('0xa8aaa1f0abdf8767d2cdd81de1132a31ff04a694', 4)
        , ('0xb716b043e76d2d28110a5f354e430cb4f54bda16', 4)
        , ('0x00653d03b147a663390dd5c5b1a55dc9cc0bd2fd', 3)
        , ('0x0348120ab9ffbbb02e471f37db019bf6c2b0bc35', 3)
        , ('0x042ebbd517908dcf1fc3276a5e35b382c246c194', 3)
        , ('0x09d57f361f794d150c04443a7b6e369120dc2bea', 3)
        , ('0x279d4a00cb930dc6202c2c6153a2289a105831ec', 3)
        , ('0x4239974d0b49c228b35ead65a25690dbe4823f45', 3)
        , ('0x49432b32f26486135e56cc92db68360b8a78657e', 3)
        , ('0x747be18e99a6c2b9f2aa4369f5e238534e5dacae', 3)
        , ('0x7c511d35c33aae98d496090c3e1ae173dbd1c530', 3)
        , ('0x7e23a0a9fd1105ca4b1dc9b7e0f0aab3b7071caa', 3)
        , ('0x7efb83820526b4fee41a0afaab1248992f607985', 3)
        , ('0x8885224cf8ee256634f628bfef326948faf78ba3', 3)
        , ('0x90c62a8a3ecba53a3339efa6be6c6570c649fb1f', 3)
        , ('0x9345d6de501e30089d045ec84a461ba4973f6ec0', 3)
        , ('0x9ec9571fa901b5c8270e40f553ba6ac2671d6844', 3)
        , ('0xaac01287db710d7f8c7cfbaee833c8b8b3546c3e', 3)
        , ('0xb68304efab87c9f4962e9fcf7fe122aa4a0c647b', 3)
        , ('0xbf9888cb20fcfa717538c4a771bdb7815fafa1da', 3)
        , ('0x005612ffb145f39be77e8b80251981043c472930', 2)
        , ('0x00e49042093a2bad2046199316048bfb393dda0b', 2)
        , ('0x03236093522cdcbac662ffbebd6a951349082b72', 2)
        , ('0x0715242c0f0390d11f925f7213f6901beefbb59f', 2)
        , ('0x093eeb5cc712a7c132161326416b20532f348729', 2)
        , ('0x0d2983a4d9e3b120d16a020a40d951166a125e0f', 2)
        , ('0x2128de0abe7a0c373740b5a005b55579b2cc9d23', 2)
        , ('0x341bac772f6944623dd5f98bd6a57ec9664a48c5', 2)
        , ('0x3a04bb9e588c7253739fc49a46a4ae8459c6c101', 2)
        , ('0x3fc1753c90421bd2669d963f3973c0e75d23c68e', 2)
        , ('0x4862edef0be598f12b0cdaa73ea6ea21374fed78', 2)
        , ('0x56960def9615f9290c219d1de336f4d7e5540cc6', 2)
        , ('0x7fe02ca835b711928505ea6725ccca6dce6db9e7', 2)
        , ('0x830c91140ad5851d5b765691e14c04101829eaea', 2)
        , ('0x838ca689c7035777872e9ef926fec853b8eddacb', 2)
        , ('0x849c1d8452126fb0b120c3abb688a1011f54d89b', 2)
        , ('0x8884f2af43bcbd9ab81f7a4ac35f421df1926810', 2)
        , ('0x8ed1374ee2601eb3fd635978b17de61b2a7b3b82', 2)
        , ('0x93d2b052a313e8766441acf102287e39e974b0ea', 2)
        , ('0x95ea04999cce305ffc0b11ae1348fce0e1584ad0', 2)
        , ('0x9a6a87671ce095d6edd1d22e75d0749f8f6487b9', 2)
        , ('0xa060870b4824b6a36862a69b6f6cec65c6d5b203', 2)
        , ('0xb148cd1c75bfeaeb0182bf99064cdbe94276b7db', 2)
        , ('0xc97fdd816fcaa82609ee3bf19854d42b20217df5', 2)
        , ('0xe0b432036739a7e98af5af8a2bf307ac02eddd70', 2)
        , ('0xe39178816faf3385943c73a0de19eed0ee78b6a4', 2)
        , ('0xfbd8a3481bb14079c6d13b5b3453c06d054015c9', 2)
        , ('0x000003e1e88a1110e961f135df8cdea4b1ffa81a', 1)
        , ('0x0011f1cc1a7cd0b0d70ae3f539e61d7540cd840b', 1)
        , ('0x007eb9fe5553d5027149a05ff715efe55ca4247a', 1)
        , ('0x009a6191f45a565b93b1d7524510fe5ba767588b', 1)
        , ('0x00fef499b2624ce9b1526ffb6c37dec77da6eb0f', 1)
        , ('0x019edcb493bd91e2b25b70f26d5d9041fd7ef946', 1)
        , ('0x028229241a160929728a1257ba668d52eab32619', 1)
        , ('0x0ae57280978ae6f633a60149e525dd82f06e8446', 1)
        , ('0x0f19b85adb3d3a58856f790324048b864c1ef87b', 1)
        , ('0x13c7bdff220cf27f382baa3d7a281614cbe54f37', 1)
        , ('0x1f2bcd78b9f4e6daee2ad0beacfb659046afb5a7', 1)
        , ('0x1ff60e72c816c30326012af3894d2d563b08959e', 1)
        , ('0x24582fd3ab36e59942b8f18e79295ea892cc7ac9', 1)
        , ('0x26dee656e7d761b01fc624da3f3fed66a2921efe', 1)
        , ('0x2723daff287ae556e870f74af3243c1c268e9804', 1)
        , ('0x2b20c62d7a6f51592ea263078f0c4e7fafc04f57', 1)
        , ('0x3124dcd240b330945896b0cdfa8dd20ed400704c', 1)
        , ('0x34155fe28ca299699b6c56e04fd4700ee65043e5', 1)
        , ('0x3d00aea89390613a7a5d874078cf9e82bf794b01', 1)
        , ('0x3e37e1336050cb6ec5b4f5dd4bc5757b277a9bdc', 1)
        , ('0x40093628f83478e98c707a271c1b049683c4a153', 1)
        , ('0x40dceaf803096e2e59c6eeeab210f9f38e0783cf', 1)
        , ('0x414201734e0380c1e8864d6eb8f705d673923d53', 1)
        , ('0x443b1a8ed01a52e857693b6e119039ae56a3e926', 1)
        , ('0x4b01629a1baf82d8ab62726776b1332539e51cec', 1)
        , ('0x4dc133d9cb9c0932c855aec9e5f75f5320523a5c', 1)
        , ('0x59900b86e14e013ebbf38d4603302080ff02b0a0', 1)
        , ('0x5c79d3d994b54f98cedb0c5d9be4842f26e2fe10', 1)
        , ('0x5d6f25d4cf84c905246cad78f96a1dd13ee57dda', 1)
        , ('0x5eb2ac0a96b20bd7fbb0cf4230c5c482cc4d9efe', 1)
        , ('0x631b40d0ad3fd20315f3c7b7fb09662c97541de7', 1)
        , ('0x63e776c2b49b46a2bbc00c31fb5073051b2d6172', 1)
        , ('0x656c90fb6d67ed9b7e291c18ef2fff8d5404eff8', 1)
        , ('0x679220ef8b751a6465f5919fdd368f6fe5effd66', 1)
        , ('0x680c8b7893fa2be9ef4ae40980b34137ba3ab3c5', 1)
        , ('0x689ad2055dc45f5d5b4d5bb2258c2fcb2baab953', 1)
        , ('0x6ce89551d2645048d709cb00ccd609c4622ca0c1', 1)
        , ('0x6f7001383b8cdde75695f63f05c4cca61c30df72', 1)
        , ('0x76997945810dc89f37d71bcb7bcd3511c948b1bd', 1)
        , ('0x78b5990ec3f97fc8b849537a48ae609775e541de', 1)
        , ('0x7a8266eb0e99340e5c8167ab19cd545c17ba0523', 1)
        , ('0x7b5ff32ead96f19731a31ebadc71ae1f234aa6a7', 1)
        , ('0x809a31ce595288ef3ee7f4ef5a717fc463dcdc0d', 1)
        , ('0x82a046dfab6c0dd8efdeec0fdac3a00918b35050', 1)
        , ('0x88822756ec33b3a18341966c3ab7a201856371d9', 1)
        , ('0x8883b11c7cc85ca85279c70c69eccc8d32cbe08a', 1)
        , ('0x8e802c0a046ffa1b81100d46b303d1a0e7e9108d', 1)
        , ('0x904c300929fe06666c51c335bbe38d57da7a04bc', 1)
        , ('0x9788301db1cde6bb33205eec2e4f6d7c1ed54625', 1)
        , ('0x9a5e4d421d72bc1835e6a7b9658ca1924d12d0e0', 1)
        , ('0x9d9df4b809f31d5c0e9578ae176c55483859415c', 1)
        , ('0x9dbbfbf966ab8519c10e811c0adf95001f278428', 1)
        , ('0x9eecb70a1fcdeb5ca0e1fbad841e2ee9db86ef61', 1)
        , ('0x9f41a4b4a09721fee705681963141035dc0023af', 1)
        , ('0xa05c74d915f5d1ae011155de5428f38a43537a77', 1)
        , ('0xa248e3b1a7247917b177a2648b15fb42bf75c114', 1)
        , ('0xa58ea377e85aea385b02d5cf7e264ff4e0137ab4', 1)
        , ('0xa80d50571b82eeb4cf284d78230ce76e071cbcbc', 1)
        , ('0xac344fe188b60b62a2d07947144d97e2fa5adfd0', 1)
        , ('0xad35308a98a8e45a277308326f6f2152fb25193d', 1)
        , ('0xad41a7558a54bdcbafc4f9ca9909a09e7ba4e127', 1)
        , ('0xb1e5ea17479c1a49faddea939aa42da3cc037f81', 1)
        , ('0xb38d649f336bc3c5289a9accdd1d5339660636b1', 1)
        , ('0xbb69b1dbecfbaff7e4f8c9636b322b7a85c58479', 1)
        , ('0xc57cdfad03134816d95a1793de7f1f1f413c5e57', 1)
        , ('0xc8c115dcb2910ee8f3dbac4056b5448c4f624bde', 1)
        , ('0xcbf97e2fa4631ad5aaac9097b2386d540e0c7615', 1)
        , ('0xcecad6e9bd16ce04249c4e11ed5e1de20ccaf90d', 1)
        , ('0xd0347eebb7537301f7da74def3bfc108970ea508', 1)
        , ('0xd34261b45d4544ab7414e7ac4d0293f11fbbb02d', 1)
        , ('0xd7e7a0e8aee886fb24d107b5914e2107e9e583aa', 1)
        , ('0xd8cb7c4da714667f603f1451e65ab759b647e868', 1)
        , ('0xda0396c581d426dd0c333d8991c1e979e02f3223', 1)
        , ('0xdb9f8b13550b478f2bdddcafa81d1c664e2c7869', 1)
        , ('0xe29662a5b0a9eab6b7df2bce5ee4d9c6f61584bc', 1)
        , ('0xe83c56c776484791ef5c15b3d9d099d704cb751b', 1)
        , ('0xe91de142e624db6644f209079f77abd348636ee6', 1)
        , ('0xf0dcd8c64eb829c0f8e4dd3c1f69aa603387dbfc', 1)
        , ('0xf6bd83a6bd35e7d5052d3e15ea4254e9101d10d5', 1)
        , ('0xf7768daa6c50b6a4b629363cf2fda61af7bde5b3', 1)
        , ('0xfcdca17445b446f2efd9a6234883e1756e937adb', 1)
        , ('0xff6492f6d2a2d1194061751c6b350e4fa5ff34f2', 1)
        , ('0xffdd93414a062d534d9262def0461939c471d52e', 1)
     ) as temp_table (address, original_count)
)
, transfers as (
    select  to_date('2017-06-22', 'yyyy-MM-dd') as day
            , address as wallet 
            , sum(original_count) as punk_balance 
    from original_holders
    group by 1,2
    
    union all 
    
    select  date_trunc('day',evt_block_time) as day 
            , `from` as wallet
            , count(*)*-1.0 as punk_balance
    from {{ source('erc20_ethereum','evt_transfer') }}
    where contract_address = lower('0xb47e3cd837dDF8e4c57F05d70Ab865de6e193BBB') -- cryptopunks
    group by 1,2
    
    union all 
    
    select  date_trunc('day',evt_block_time) as day 
            , `to` as wallet
            , count(*) as punk_balance
    from {{ source('erc20_ethereum','evt_transfer') }}
    where contract_address = lower('0xb47e3cd837dDF8e4c57F05d70Ab865de6e193BBB') -- cryptopunks
    group by 1,2
)
, punk_transfer_summary as (
    select  day
            , wallet
            , sum(punk_balance) as daily_transfer_sum
    from transfers 
    group by day, wallet
)
, base_data as (
    with all_days  as (select explode(sequence(to_date('2017-06-22'), to_date(now()), interval 1 day)) as day)
    , all_wallets as (select distinct wallet from punk_transfer_summary)
    
    select  day
            , wallet
    from all_days full outer join all_wallets on true
)
, combined_table as (
    select base_data.day
            , base_data.wallet
            , sum(coalesce(daily_transfer_sum,0)) over (partition by base_data.wallet order by base_data.day) as holding
    from base_data
    left join punk_transfer_summary on base_data.day = punk_transfer_summary.day and base_data.wallet = punk_transfer_summary.wallet 
)
    
select day
        , count(wallet) filter (where holding > 0) as unique_wallets
from combined_table
group by 1
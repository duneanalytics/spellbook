version: 2

models:
  - name: keep3r_network_ethereum_view_job_migrations
    meta:
      blockchain: ethereum
      project: keep3r_network
      contributors: [agaperste, wei3erHase]
    config:
      tags: ["ethereum", "keep3r_network", "view"]
    description: >
      Sometimes a protocol would want to upgrade their automation contracts (aka job) and would need to migrate their credicts, instead of unstaking (which takes weeks), a protocol shuts down the old job address, and continues exactly as it was with the new address. This tracks the old to new address migration for a job.
    columns:
      - &event
        name: event
        description: "Type of event: LiquidityAddition, LiquidityWithdrawal, CreditsReward, KeeperWork, JobMigrationIn, JobMigrationOut"
      - &evt_index
        name: evt_index
        tests:
          - not_null
      - &job
        name: job
        description: "The smart contract address that wishes an external entity to perform an action"
        tests:
          - not_null
      - &keep3r
        name: keep3r
        description: "Contract address for keep3r"
      - &timestamp
        name: timestamp
        description: "Time when the job was called"
        tests:
          - not_null
      - &tx_hash
        name: tx_hash
        description: "Transaction hash for the transaction in which the job was called"
        tests:
          - not_null
  - name: keep3r_network_ethereum_view_job_liquidity_log
    meta:
      blockchain: ethereum
      project: keep3r_network
      contributors: [agaperste, wei3erHase]
    config:
      tags: ["ethereum", "keep3r_network", "view"]
    description: >
      This tracks liquidity additon and withdrawl to the job.
    columns:
      - &amount
        name: amount
        description: "Amount of token for the job"
      - *event
      - *evt_index
      - *job
      - *keep3r
      - *timestamp
      - &token
        name: token
        description: "The token in which the amount for the job is paid"
        tests:
          - not_null
      - *tx_hash
  - name: keep3r_network_ethereum_view_job_credits_log
    meta:
      blockchain: ethereum
      project: keep3r_network
      contributors: [agaperste, wei3erHase]
    config:
      tags: ["ethereum", "keep3r_network", "view"]
    description: >
      This tracks the accrual of credits generated by staked liquidity. Credits can be deducted after keeperWorked event or restarsted every 5 days.

    columns:
      - *amount
      - *event
      - *evt_index
      - *job
      - *keep3r
      - &keeper
        name: keeper
        description: "An external address that executes a job. Keepers are bots, scripts, other contracts, or simply EOA accounts that trigger events."
      - &period_credits
        name: period_credits
        description: "Credits in this reward period"
      - *timestamp
      - *token
      - *tx_hash
  - name: keep3r_network_ethereum_view_job_log
    meta:
      blockchain: ethereum
      project: keep3r_network
      contributors: [agaperste, wei3erHase]
    config:
      tags: ["ethereum", "keep3r_network", "view"]
    description: >
      This tracks details about a Keep3r job, such as when keeper executed a job, when credits were minted, when liquidity was added etc.
    columns:
      - *amount
      - *event
      - *evt_index
      - *job
      - *keep3r
      - *keeper
      - *period_credits
      - *timestamp
      - *token
      - *tx_hash

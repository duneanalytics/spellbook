version: 2

models:
  - name: omen_gnosis_trades
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','trades', 'omen','dex']
    description: >
        A table containing all trades of omen on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_day
            - tx_hash
            - evt_index 
            - outcomeSlot
    columns:
      - &block_time
        name: block_time
        description: "UTC event block time of each DEX trade"
      - &block_day
        name: block_day
        description: "UTC event block day of each trade"
      - &tx_from
        name: tx_from
        description: "Address which initiated the transaction"
      - &tx_to
        name: tx_to
        description: "Address which received the transaction"
      - &tx_hash
        name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the DEX"
      - &evt_index
        name: evt_index
        description: ""
      - &fixedProductMarketMaker
        name: fixedProductMarketMaker
        description: "Address of the Fixed Product Market Maker"
      - &collateralToken
        name: collateralToken
        description: "Address of the collateral token"
      - &symbol
        name: symbol
        description: "Symbol of the collateral token"
      - &address
        name: address
        description: "Address of buyer/seller"
      - &outcomeSlot
        name: outcomeSlot
        description: "Index every outcome"
      - &outcomeIndex
        name: outcomeIndex
        description: "Index of the outcome choosen"
      - &amount
        name: amount
        description: "Amount in native currency that was bought/sold"
      - &feeAmount
        name: feeAmount
        description: "Fee amount in native currency that was charged"
      - &outcomeTokens
        name: outcomeTokens
        description: "Amount to tokens Minted/Burnt"

  - name: omen_gnosis_markets
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','markets', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - fixedProductMarketMaker
            - questionId 
            - conditionId
            - conditionIds_index
    columns:
      - *block_time
      - *block_day
      - *tx_hash
      - &questionId
        name: questionId
        description: "Question ID"
      - &conditionId
        name: conditionId
        description: "Condition ID"
      - &oracle
        name: oracle
        description: "Address of Oracle"
      - &outcomeSlotCount
        name: outcomeSlotCount
        description: "Number of outcomes"
      - &question
        name: question
        description: "Question"
      - *fixedProductMarketMaker
      - &conditionalTokens
        name: conditionalTokens
        description: "Conditional Token"
      - *collateralToken
      - &fee
        name: fee
        description: "Fee of the market"
      - &conditionIds_index
        name: conditionIds_index
        description: "Index of conditionID"
      - &category
        name: category
        description: "Category of question"

  - name: omen_gnosis_liquidity
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','liquidity', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - amount_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - *fixedProductMarketMaker
      - &funder
        name: funder
        description: "Address on the wallet adding/removing liquidity"
      - &shares
        name: shares
        description: "Amount of shares"
      - &collateralRemovedFromFeePool
        name: collateralRemovedFromFeePool
        description: "Colateral removed"
      - &amount_index
        name: amount_index
        description: "amount index"
      - *amount
      - &action
        name: action
        description: "Cam be Min or Burn"

  - name: omen_gnosis_payouts
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','payouts', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - indexSets_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - &evt_contract_address
        name: evt_contract_address
        description: "Address of ConditionalTokens"
      - &redeemer
        name: redeemer
        description: "Address on the wallet redeemeing"
      - *collateralToken
      - &parentCollectionId
        name: parentCollectionId
        description: "parent Collection Id"
      - *conditionId
      - &payout
        name: payout
        description: "payout in native currency"
      - &indexSets_index
        name: indexSets_index
        description: "Index of indexSets"
      - &indexSets
        name: indexSets
        description: "indexSets"

  - name: omen_gnosis_resolution
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','resolution', 'omen','dex']
    description: >
        A table containing all omen markets resolutions on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - payoutNumerators_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - *evt_contract_address
      - *conditionId
      - *oracle
      - *questionId
      - *conditionId
      - &payoutNumerators_index
        name: payoutNumerators_index
        description: "Index of payoutNumerators"
      - &payoutNumerator
        name: payoutNumerator
        description: "payoutNumerator"

  - name: omen_gnosis_reserves_delta
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','reserves_delta', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - amount_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - *fixedProductMarketMaker
      - *address
      - *shares
      - *amount_index
      - *amount
      - &fees
        name: fees
        description: "fees"
      - *action
      - &reserves_delta
        name: reserves_delta
        description: "reserves_delta"
version: 2

models:
  - name: omen_gnosis_trades
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','trades', 'omen','dex']
    description: >
        A table containing all trades of omen on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_day
            - tx_hash
            - evt_index 
            - outcomeSlot
    columns:
      - &block_time
        name: block_time
        description: "Event UTC block time of each prediction market trade"
      - &block_day
        name: block_day
        description: "Event UTC block day of each prediction market trade"
      - &tx_from
        name: tx_from
        description: "Address which initiated the transaction"
      - &tx_to
        name: tx_to
        description: "Address which received the transaction"
      - &tx_hash
        name: tx_hash
        description: "Unique transaction hash value tied to each transaction on the prediction market"
      - &evt_index
        name: evt_index
        description: "Index of the log event in the block"
      - &fixedProductMarketMaker
        name: fixedProductMarketMaker
        description: "Address of the Fixed Product Market Maker"
      - &address
        name: address
        description: "Address of buyer or seller"
      - &outcomeSlot
        name: outcomeSlot
        description: "Outcome slot for the specific Fixed Product Market Maker"
      - &outcomeIndex
        name: outcomeIndex
        description: "Index of the outcome choosen"
      - &amount
        name: amount
        description: "Amount in native currency that was bought or sold"
      - &feeAmount
        name: feeAmount
        description: "Fee amount in native currency that was charged"
      - &outcomeTokens
        name: outcomeTokens
        description: "Amount of conditional tokens that minted or burnt by the Fixed Product Market Maker"
      - &action
        name: action
        description: "Action excetuted by the trader, 'Buy' or 'Sell'"

  - name: omen_gnosis_liquidity
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','liquidity', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - amount_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - *fixedProductMarketMaker
      - &funder
        name: funder
        description: "Address on the wallet adding/removing liquidity"
      - &shares
        name: shares
        description: "Amount of shares"
      - &collateralRemovedFromFeePool
        name: collateralRemovedFromFeePool
        description: "Colateral removed"
      - &amount_index
        name: amount_index
        description: "amount index"
      - *amount
      - *action

  - name: omen_gnosis_reserves_delta
    meta:
      blockchain: gnosis
      sector: dex
      project: omen
      contributors: hdser
    config:
      tags: ['gnosis','reserves_delta', 'omen','dex']
    description: >
        A table containing all omen markets on Gnosis
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - tx_hash 
            - evt_index
            - amount_index
    columns:
      - *block_time
      - *block_day
      - *tx_from
      - *tx_to
      - *tx_hash
      - *evt_index
      - *fixedProductMarketMaker
      - *address
      - *shares
      - *amount_index
      - *amount
      - &fees
        name: fees
        description: "fees"
      - *action
      - &reserves_delta
        name: reserves_delta
        description: "reserves_delta"